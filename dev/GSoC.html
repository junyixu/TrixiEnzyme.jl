<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GSoC · TrixiEnzyme.jl</title><meta name="title" content="GSoC · TrixiEnzyme.jl"/><meta property="og:title" content="GSoC · TrixiEnzyme.jl"/><meta property="twitter:title" content="GSoC · TrixiEnzyme.jl"/><meta name="description" content="Documentation for TrixiEnzyme.jl."/><meta property="og:description" content="Documentation for TrixiEnzyme.jl."/><meta property="twitter:description" content="Documentation for TrixiEnzyme.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">TrixiEnzyme.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="api.html">API reference</a></li><li><a class="tocitem" href="examples.html">Examples</a></li><li class="is-active"><a class="tocitem" href="GSoC.html">GSoC</a><ul class="internal"><li><a class="tocitem" href="#Project-Overview"><span>Project Overview</span></a></li><li><a class="tocitem" href="#Key-Highlights"><span>Key Highlights</span></a></li><li><a class="tocitem" href="#Constraints-and-Future-Work"><span>Constraints and Future Work</span></a></li><li><a class="tocitem" href="#Acknowledgments"><span>Acknowledgments</span></a></li></ul></li><li><a class="tocitem" href="notes.html">Notes</a></li><li><a class="tocitem" href="Contact.html">Contact Developer</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="GSoC.html">GSoC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="GSoC.html">GSoC</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/junyixu/TrixiEnzyme.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/junyixu/TrixiEnzyme.jl/blob/main/docs/src/GSoC.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Final-Report:-GSoC-&#39;24"><a class="docs-heading-anchor" href="#Final-Report:-GSoC-&#39;24">Final Report: GSoC &#39;24</a><a id="Final-Report:-GSoC-&#39;24-1"></a><a class="docs-heading-anchor-permalink" href="#Final-Report:-GSoC-&#39;24" title="Permalink"></a></h1><ul><li>Student Name: Junyi(<a href="https://github.com/junyixu">@junyixu</a>).</li><li>Organization: Trixi Framework community.</li><li>Mentors: Michael(<a href="https://github.com/sloede">@sloede</a>) and Hendrik(<a href="https://github.com/ranocha">@ranocha</a>)</li><li>Project: Integrating the Modern CFD Package Trixi.jl with Compiler-Based Auto-Diff via Enzyme.jl</li><li>Project Link: <a href="https://github.com/junyixu/TrixiEnzyme.jl">https://github.com/junyixu/TrixiEnzyme.jl</a></li></ul><h2 id="Project-Overview"><a class="docs-heading-anchor" href="#Project-Overview">Project Overview</a><a id="Project-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Project-Overview" title="Permalink"></a></h2><p>Trixi.jl is a numerical simulation framework for conservation laws written in Julia. The integration of Trixi.jl with Compiler-Based (LLVM level) automatic differentiation via Enzyme.jl offers the following benefits: facilitates rapid forward mode AD, enables reverse mode AD, supports cross-language AD, and critically, supports mutating operations and caching, on which Trixi.jl relies, to enhance the performance of both simulation runs and AD. The final deliverable will include as many of Trixi&#39;s advanced features as possible, such as adaptive mesh refinement, shock capturing, etc., showcasing the benefits of differentiable programming in Julia&#39;s ecosystem.</p><ul><li><strong><a href="https://junyixu.github.io/TrixiEnzyme.jl/dev/api.html#TrixiEnzyme.jacobian_enzyme_forward">Forward Mode</a> Automatic Differentiation (AD) for Discontinuous Galerkin Collocation Spectral Element Method (DGSEM)</strong>: Implement forward mode automatic differentiation to enhance the calculation of derivatives in DG methods, improving computational efficiency and accuracy for various applications.</li><li><strong><a href="https://junyixu.github.io/TrixiEnzyme.jl/dev/api.html#TrixiEnzyme.jacobian_enzyme_reverse-Tuple{Any}">Reverse Mode</a> Automatic Differentiation for DG</strong>.</li><li><strong>Improve Performance</strong>:<ul><li><strong>Extract Parameters Passed to Enzyme</strong>: Implement a systematic approach to extract and manage parameters passed to Enzyme, ensuring optimal configuration and efficiency in the execution of AD tasks.</li><li><strong><code>batchsize</code> for Jacobians</strong>:<ul><li><strong>Optimize for Memory Bandwidth</strong>: Fine-tune the batch size in Jacobian computations to optimize the use of memory bandwidth, thus improving the overall performance and speed of the computations.</li><li><strong>Automatically <a href="https://junyixu.github.io/TrixiEnzyme.jl/dev/api.html#TrixiEnzyme.pick_batchsize">Pick</a> <code>batchsize</code></strong></li></ul></li></ul></li><li><strong>Explore Enzyme Custom Rules</strong>: Investigate and implement custom rules within the Enzyme AD framework to handle specific cases and operations that are not optimally managed by the default settings, enhancing the flexibility and capability of the AD processes.</li></ul><p>Please note that the last step was planned but remains incomplete due to time constraints and this step will be completed in the future if possible.</p><h2 id="Key-Highlights"><a class="docs-heading-anchor" href="#Key-Highlights">Key Highlights</a><a id="Key-Highlights-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Highlights" title="Permalink"></a></h2><h3 id="Function-Prototyping"><a class="docs-heading-anchor" href="#Function-Prototyping">Function Prototyping</a><a id="Function-Prototyping-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Prototyping" title="Permalink"></a></h3><ul><li>Functions intended for automatic differentiation with <code>Enzyme.autodiff</code> should adhere to specific naming conventions:<ul><li>Functions must start with <code>enzyme_</code>.</li><li>The primary role of these functions is to unpack <code>semi.cache</code> and accurately recreate <code>cache</code> for effective use with Enzyme’s APIs.</li></ul></li></ul><h3 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h3><ul><li>The functions <code>jacobian_enzyme_forward</code> and <code>jacobian_enzyme_reverse</code> are configured to behave similarly to <code>jacobian_ad_forward</code>, with the primary distinction being how <code>batchsize</code> is chosen:<ul><li>An alternative usage pattern involves defining new functions prefixed with <code>enzyme_</code> and passing them to <code>jacobian_enzyme_forward</code> or <code>jacobian_enzyme_reverse</code> for differentiation.</li></ul></li></ul><h3 id="Optimization-Strategies"><a class="docs-heading-anchor" href="#Optimization-Strategies">Optimization Strategies</a><a id="Optimization-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-Strategies" title="Permalink"></a></h3><ul><li>To enhance performance, several optimization strategies are recommended:<ul><li>Reuse containers for shadow variables during middlebatching and utilize the <code>@batch</code> macro for multithreading acceleration to improve computational efficiency.</li><li>Minimize the number of arguments extracted from <code>semi.cache</code> to reduce overhead and streamline computations.</li><li>Current benchmarks for Enzyme indicate mixed results. In scenarios involving smaller caches, like in toy models, <code>jacobian_enzyme(semi)</code> performs better than <code>ForwardDiff</code>. However, in the context of Discontinuous Galerkin Collocation Spectral Element Method (DGSEM) simulations, the performance may lag behind <code>jacobian_ad_forward(semi)</code> due to the challenges associated with large cache sizes (<code>elements._surface_flux_values</code> and <code>cache.interfaces._u</code>) and the complexities involved in unpacking and recreating the cache.</li></ul></li></ul><p>This package aims to provide a robust framework for integrating advanced differentiation techniques into Trixi, addressing both performance and usability to facilitate high-quality computational research and development.</p><h2 id="Constraints-and-Future-Work"><a class="docs-heading-anchor" href="#Constraints-and-Future-Work">Constraints and Future Work</a><a id="Constraints-and-Future-Work-1"></a><a class="docs-heading-anchor-permalink" href="#Constraints-and-Future-Work" title="Permalink"></a></h2><ul><li><strong>Make Reverse Mode AD Work with Polyester.jl</strong>: Address compatibility issues and integrate reverse mode AD with Polyester.jl for multithreading capabilities, aiming to enhance performance and scalability of the AD operations across different computing environments.</li><li><strong>Integrate Enzyme with GPU Kernels</strong>: Extend the functionality of Enzyme by integrating it with GPU kernels, allowing AD operations to leverage the parallel processing power of GPUs.</li></ul><h2 id="Acknowledgments"><a class="docs-heading-anchor" href="#Acknowledgments">Acknowledgments</a><a id="Acknowledgments-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgments" title="Permalink"></a></h2><p>The entire project, along with this website, is developed and maintained by Junyi(<a href="https://github.com/junyixu">@junyixu</a>). The whole project is under the guidance of two outstanding professors, Michael(<a href="https://github.com/sloede">@sloede</a>) and Hendrik(<a href="https://github.com/ranocha">@ranocha</a>), from Trixi Framework community.</p><p>The project also received support from other Julia contributors, including Benedict from Trixi Framework community.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="examples.html">« Examples</a><a class="docs-footer-nextpage" href="notes.html">Notes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Monday 26 August 2024 13:46">Monday 26 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
